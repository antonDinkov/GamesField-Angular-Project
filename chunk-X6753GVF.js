import{a as p}from"./chunk-WJ5ZAXFD.js";import{i as g}from"./chunk-U6HMZKYF.js";import{$ as n,da as l,ha as u,w as r,wa as a}from"./chunk-LF5J2TJP.js";var h=class o{constructor(e){this.httpClient=e;this.checkSession().subscribe({next:t=>{this._user.set(t),this._isLoggedIn.set(!0)},error:()=>{localStorage.removeItem("user"),this._user.set(null),this._isLoggedIn.set(!1)}})}_isLoggedIn=a(!1);isLoggedIn=this._isLoggedIn.asReadonly();_user=a(null);user=this._user.asReadonly();apiUrl=p.apiUrl;register(e,t,s,m,d){return this.httpClient.post(`${this.apiUrl}/register`,{firstName:e,lastName:t,email:s,password:m,repass:d},{withCredentials:!0}).pipe(n(i=>{this._isLoggedIn.set(!0),this._user.set(i.user),localStorage.setItem("user",JSON.stringify(i.user))}),r(i=>i.user))}login(e,t){return this.httpClient.post(`${this.apiUrl}/login`,{email:e,password:t},{withCredentials:!0}).pipe(n(s=>{this._isLoggedIn.set(!0),this._user.set(s.user),localStorage.setItem("user",JSON.stringify(s.user))}))}logout(){return this.httpClient.get(`${this.apiUrl}/logout`,{withCredentials:!0}).pipe(n(()=>{this._isLoggedIn.set(!1),this._user.set(null),localStorage.removeItem("user")}))}checkSession(){return this.httpClient.get(`${this.apiUrl}/me`,{withCredentials:!0}).pipe(r(e=>e.user))}updateUserInfo(e){return this.httpClient.put(`${this.apiUrl}/update/profile`,e,{withCredentials:!0}).pipe(r(t=>t.user))}removePicture(e){return this.httpClient.put(`${this.apiUrl}/update/profile/remove-picture`,{email:e},{withCredentials:!0}).pipe(r(t=>t.user))}static \u0275fac=function(t){return new(t||o)(u(g))};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{h as a};
