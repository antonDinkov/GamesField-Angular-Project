import{f as u,o as p}from"./chunk-QOPNELFI.js";import{K as i,O as g,S as l,ea as a,q as o}from"./chunk-RYPZXW43.js";var h=class n{constructor(e){this.httpClient=e;this.checkSession().subscribe({next:t=>{this._user.set(t),this._isLoggedIn.set(!0)},error:()=>{localStorage.removeItem("user"),this._user.set(null),this._isLoggedIn.set(!1)}})}_isLoggedIn=a(!1);isLoggedIn=this._isLoggedIn.asReadonly();_user=a(null);user=this._user.asReadonly();apiUrl=p.apiUrl;register(e,t,s,m,d){return this.httpClient.post(`${this.apiUrl}/register`,{firstName:e,lastName:t,email:s,password:m,repass:d},{withCredentials:!0}).pipe(i(r=>{this._isLoggedIn.set(!0),this._user.set(r.user),localStorage.setItem("user",JSON.stringify(r.user))}),o(r=>r.user))}login(e,t){return this.httpClient.post(`${this.apiUrl}/login`,{email:e,password:t},{withCredentials:!0}).pipe(i(s=>{this._isLoggedIn.set(!0),this._user.set(s.user),localStorage.setItem("user",JSON.stringify(s.user))}))}logout(){return this.httpClient.get(`${this.apiUrl}/logout`,{withCredentials:!0}).pipe(i(()=>{this._isLoggedIn.set(!1),this._user.set(null),localStorage.removeItem("user")}))}checkSession(){return this.httpClient.get(`${this.apiUrl}/me`,{withCredentials:!0}).pipe(o(e=>e.user))}static \u0275fac=function(t){return new(t||n)(l(u))};static \u0275prov=g({token:n,factory:n.\u0275fac,providedIn:"root"})};export{h as a};
