import{a as m}from"./chunk-WJ5ZAXFD.js";import{f as a,h as r,j as u,l as n,o as g,r as p,ta as h,x as l}from"./chunk-NQD7YVRL.js";var d=class o{constructor(e){this.httpClient=e;this.checkSession().subscribe({next:t=>{this._user.set(t),this._isLoggedIn.set(!0)},error:()=>{localStorage.removeItem("user"),this._user.set(null),this._isLoggedIn.set(!1)}})}_isLoggedIn=l(!1);isLoggedIn=this._isLoggedIn.asReadonly();_user=l(null);user=this._user.asReadonly();apiUrl=m.apiUrl;register(e,t,s,c,f){return this.httpClient.post(`${this.apiUrl}/register`,{firstName:e,lastName:t,email:s,password:c,repass:f},{withCredentials:!0}).pipe(n(i=>{this._isLoggedIn.set(!0),this._user.set(i.user),localStorage.setItem("user",JSON.stringify(i.user))}),r(i=>i.user))}login(e,t){return this.httpClient.post(`${this.apiUrl}/login`,{email:e,password:t},{withCredentials:!0}).pipe(n(s=>{this._isLoggedIn.set(!0),this._user.set(s.user),localStorage.setItem("user",JSON.stringify(s.user))}))}logout(){return this.httpClient.get(`${this.apiUrl}/logout`,{withCredentials:!0}).pipe(n(()=>{this._isLoggedIn.set(!1),this._user.set(null),localStorage.removeItem("user")}))}checkSession(){return this.httpClient.get(`${this.apiUrl}/me`,{withCredentials:!0}).pipe(r(e=>(this._isLoggedIn.set(!0),this._user.set(e.user),localStorage.setItem("user",JSON.stringify(e.user)),e.user)),u(e=>(this._isLoggedIn.set(!1),this._user.set(null),localStorage.removeItem("user"),a(null))))}updateUserInfo(e){return this.httpClient.put(`${this.apiUrl}/update/profile`,e,{withCredentials:!0}).pipe(r(t=>t.user))}removePicture(e){return this.httpClient.put(`${this.apiUrl}/update/profile/remove-picture`,{email:e},{withCredentials:!0}).pipe(r(t=>t.user))}static \u0275fac=function(t){return new(t||o)(p(h))};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};export{d as a};
